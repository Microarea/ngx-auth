{"version":3,"file":"tb-auth.js","sources":["ng://@tb/auth/lib/models/login-request.ts","ng://@tb/auth/lib/models/login-response.ts","ng://@tb/auth/lib/models/logoff-request.ts","ng://@tb/auth/lib/models/logoff-response.ts","ng://@tb/auth/lib/models/storage-vars.ts","ng://@tb/auth/lib/models/subscription.model.ts","ng://@tb/auth/lib/models/is-valid-token-request.ts","ng://@tb/auth/lib/models/auth-environment.ts","ng://@tb/auth/lib/models/auth-connection-options.ts","ng://@tb/auth/lib/auth.service.ts","ng://@tb/auth/lib/auth.guard.ts","ng://@tb/auth/lib/auth.interceptor.ts","ng://@tb/auth/lib/pages/login.component.ts","ng://@tb/auth/lib/logoff.component.ts","ng://@tb/auth/lib/auth.module.ts"],"sourcesContent":["export class LoginRequest {\r\n    token = ''; // se presente, sto facendo una autologin\r\n    appId = 'M4'; // identificativo dell'applicazione che sta effettuando la login (da tabellare)\r\n    accountName!: string;\r\n    password!: string;\r\n    subscriptionKey!: string; // login su una specifica Subscription\r\n}\r\n","export interface LoginResponse {\r\n    Result: boolean;\r\n    Message: string;\r\n    ResultCode: number;\r\n    JwtToken: string;\r\n    ExpirationDate: string;\r\n    RegionalSettings: string;\r\n    Language: string;\r\n    Roles: string;\r\n}\r\n","export class LogoffRequest {\r\n    token: string | null;\r\n    constructor(token: string | null) {\r\n        this.token = token;\r\n    }\r\n}\r\n","export interface LogoffResponse {\r\n    Result: boolean;\r\n    Message: string;\r\n    Content: any;\r\n    Code: 0;\r\n}\r\n","export class StorageVars {\r\n    public static JWT = 'M4_jwt_token';\r\n    public static CULTURE = 'M4_culture';\r\n    public static UI_CULTURE = 'M4_ui_culture';\r\n    public static ACCOUNT_NAME = 'M4_account_name';\r\n    public static ACCOUNT_ROLES = 'M4_account_roles';\r\n    public static SUBSCRIPTION = 'M4_subscription';\r\n    public static SUBSCRIPTION_DESCRIPTION = 'M4_subscription_desc';\r\n}\r\n","export interface Subscription {\r\n    subscriptionkey: string;\r\n    description: string;\r\n}\r\n","export class IsValidTokenRequest {\r\n    constructor(public token = '') {}\r\n}\r\n","export interface TbAuthEnvironment {\r\n    auth: {\r\n        url: string;\r\n        subscriptionSelection: boolean;\r\n        appId: string;\r\n        redirectUrl: string;\r\n        sessionStorage: boolean;\r\n        logo: string;\r\n    };\r\n}\r\n","/**\r\n * Instance of this interface could be used to configure \"ConnectionService\".\r\n */\r\nexport class AuthConnectionOptions {\r\n    /**\r\n     * Controls the Internet connectivity heartbeat system. Default value is 'true'.\r\n     */\r\n    enableHeartbeat = true;\r\n    /**\r\n     * Url used for checking Internet connectivity, heartbeat system periodically makes \"HEAD\" requests to this URL to determine Internet\r\n     * connection status. Default value is \"//internethealthtest.org\".\r\n     */\r\n    heartbeatUrl = '//internethealthtest.org';\r\n    /**\r\n     * Interval used to check Internet connectivity specified in milliseconds. Default value is \"30000\".\r\n     */\r\n    heartbeatInterval = 5000; // TODO abbassare a 30s\r\n    /**\r\n     * Interval used to retry Internet connectivity checks when an error is detected (when no Internet connection). Default value is \"1000\".\r\n     */\r\n    heartbeatRetryInterval = 1000;\r\n    /**\r\n     * HTTP method used for requesting heartbeat Url. Default is 'head'.\r\n     */\r\n    requestMethod: 'get' | 'post' | 'head' | 'options' = 'head';\r\n\r\n    constructor(heartbeatUrl: string) {\r\n        this.heartbeatUrl = heartbeatUrl;\r\n    }\r\n}\r\n","import { Injectable, Inject, Injector, EventEmitter, OnDestroy } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Router } from '@angular/router';\r\n\r\nimport * as _ from 'lodash';\r\n\r\nimport { of, Subject, Subscription, fromEvent, timer, Observable } from 'rxjs';\r\nimport { tap, map, switchMap, retryWhen, delay, debounceTime, startWith } from 'rxjs/operators';\r\n\r\nimport { StorageVars } from './models/storage-vars';\r\n\r\nimport { LoginRequest } from './models/login-request';\r\nimport { LoginResponse } from './models/login-response';\r\nimport { LogoffRequest } from './models/logoff-request';\r\nimport { LogoffResponse } from './models/logoff-response';\r\nimport { IsValidTokenRequest } from './models/is-valid-token-request';\r\nimport { OperationResult } from './models/operation-result';\r\nimport { TbAuthEnvironment } from './models/auth-environment';\r\nimport { AuthConnectionOptions } from './models/auth-connection-options';\r\nimport { AuthConnectionState } from './models/auth-connection-state';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TbAuthService implements OnDestroy {\r\n    private static DEFAULT_ENV: TbAuthEnvironment = {\r\n        auth: {\r\n            url: 'asdf',\r\n            subscriptionSelection: false,\r\n            appId: 'M4',\r\n            redirectUrl: '/',\r\n            sessionStorage: false,\r\n            logo:\r\n                // tslint:disable-next-line: max-line-length\r\n                'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAABGCAYAAABL0p+yAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA+hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ1dWlkOjVEMjA4OTI0OTNCRkRCMTE5MTRBODU5MEQzMTUwOEM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc4MURERERGRDlFQTExRTlBNUE4RjU5NDIzMzM0MTlGIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc4MURERERFRDlFQTExRTlBNUE4RjU5NDIzMzM0MTlGIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozMzBGMEZEMTZFRDcxMUU4ODNCMkZCMjREQ0JEN0Q0QyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozMzBGMEZEMjZF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'\r\n        }\r\n    };\r\n    private env: TbAuthEnvironment;\r\n\r\n    private stateChangeEventEmitter = new EventEmitter<AuthConnectionState>();\r\n    private currentConnectionState: AuthConnectionState = {\r\n        hasBackendAccess: false,\r\n        hasNetworkConnection: window.navigator.onLine\r\n    };\r\n    private offlineSubscription!: Subscription;\r\n    private onlineSubscription!: Subscription;\r\n    private httpSubscription!: Subscription;\r\n    private serviceOptions: AuthConnectionOptions;\r\n\r\n    loggedOut$ = new Subject();\r\n    errorMessage = '';\r\n\r\n    get router() {\r\n        return this.injector.get<Router>(Router);\r\n    }\r\n\r\n    constructor(@Inject('env') env: TbAuthEnvironment, private http: HttpClient, private injector: Injector) {\r\n        this.env = _.defaults({}, env, TbAuthService.DEFAULT_ENV);\r\n        console.log('this.env', this.env);\r\n        this.serviceOptions = new AuthConnectionOptions(this.getBaseUrl());\r\n\r\n        this.checkNetworkState();\r\n        this.checkBackendState();\r\n    }\r\n\r\n    private checkBackendState() {\r\n        if (this.httpSubscription) {\r\n            this.httpSubscription.unsubscribe();\r\n        }\r\n\r\n        if (this.serviceOptions.enableHeartbeat) {\r\n            this.httpSubscription = timer(0, this.serviceOptions.heartbeatInterval)\r\n                .pipe(\r\n                    switchMap(() => this.http.get(this.serviceOptions.heartbeatUrl, { responseType: 'text' })),\r\n                    retryWhen(errors =>\r\n                        errors.pipe(\r\n                            // log error message\r\n                            tap(val => {\r\n                                console.error('Http error:', val);\r\n                                this.currentConnectionState.hasBackendAccess = false;\r\n                                this.emitEvent();\r\n                            }),\r\n                            // restart after 5 seconds\r\n                            delay(this.serviceOptions.heartbeatRetryInterval)\r\n                        )\r\n                    )\r\n                )\r\n                .subscribe(result => {\r\n                    this.currentConnectionState.hasBackendAccess = true;\r\n                    this.emitEvent();\r\n                });\r\n        } else {\r\n            this.currentConnectionState.hasBackendAccess = false;\r\n            this.emitEvent();\r\n        }\r\n    }\r\n\r\n    private checkNetworkState() {\r\n        this.onlineSubscription = fromEvent(window, 'online').subscribe(() => {\r\n            this.currentConnectionState.hasNetworkConnection = true;\r\n            this.checkBackendState();\r\n            this.emitEvent();\r\n        });\r\n\r\n        this.offlineSubscription = fromEvent(window, 'offline').subscribe(() => {\r\n            this.currentConnectionState.hasNetworkConnection = false;\r\n            this.checkBackendState();\r\n            this.emitEvent();\r\n        });\r\n    }\r\n\r\n    private emitEvent() {\r\n        this.stateChangeEventEmitter.emit(this.currentConnectionState);\r\n    }\r\n\r\n    /**\r\n     * Monitor Network & Internet connection status by subscribing to this observer.\r\n     * If you set \"reportcurrentConnectionState\" to \"false\" then\r\n     * function will not report current status of the connections when initially subscribed.\r\n     * @param reportcurrentConnectionState Report current state when initial subscription. Default is \"true\"\r\n     */\r\n    monitorConnectionStatus(reportcurrentConnectionState = true): Observable<AuthConnectionState> {\r\n        return reportcurrentConnectionState\r\n            ? this.stateChangeEventEmitter.pipe(\r\n                  debounceTime(300),\r\n                  startWith(this.currentConnectionState)\r\n              )\r\n            : this.stateChangeEventEmitter.pipe(debounceTime(300));\r\n    }\r\n\r\n    /**\r\n     * Ritorna la base url del backend,\r\n     * caricata da un file di configurazione caricato dinamicamente (assets/environment.json)\r\n     */\r\n    getBaseUrl() {\r\n        return this.env.auth.url;\r\n    }\r\n\r\n    /*\r\n      {\r\n        type: JWT,\r\n        appid: M4,\r\n        securityValue: jwtEncoded\r\n      }\r\n    */\r\n    getAuthorizationHeader(): string {\r\n        return JSON.stringify({\r\n            Type: 'JWT',\r\n            AppId: 'M4',\r\n            SecurityValue: this.getToken()\r\n        });\r\n    }\r\n\r\n    login(loginRequest: LoginRequest): Promise<LoginResponse> {\r\n        // console.log('authService.login - loginRequest', loginRequest);\r\n        return this.http\r\n            .post<LoginResponse>(this.getLoginUrl(), loginRequest)\r\n            .pipe(\r\n                map((loginResponse: LoginResponse) => {\r\n                    if (!loginResponse.Result) {\r\n                        this.clearStorage();\r\n                        loginResponse.Message = loginResponse.Message ? loginResponse.Message : 'Login error...';\r\n                        this.errorMessage = loginResponse.Message;\r\n                        return loginResponse;\r\n                    }\r\n\r\n                    this.storageData(loginResponse);\r\n\r\n                    return loginResponse;\r\n                })\r\n            )\r\n            .toPromise();\r\n    }\r\n\r\n    async isValidToken(authtoken = '') {\r\n        if (!authtoken) {\r\n            return of(false);\r\n        }\r\n\r\n        return this.http\r\n            .post<OperationResult>(this.getIsValidTokenUrl(), new IsValidTokenRequest(authtoken))\r\n            .pipe(\r\n                tap((jObj: any) => {\r\n                    // console.log('isValidToken - response', jObj);\r\n                    if (!jObj.Result) {\r\n                        jObj.Message = jObj.Message ? jObj.Message : 'isValidToken error...';\r\n                        this.clearStorage();\r\n                        this.errorMessage = jObj.Message;\r\n                    }\r\n                })\r\n            )\r\n            .toPromise();\r\n    }\r\n\r\n    public getCompaniesForUser(user: string) {\r\n        return this.http.get<OperationResult>(this.getSubsKeysForAccountUrl() + user).pipe(\r\n            map((res: any) => {\r\n                if (!res || !res.Result) return [];\r\n                return res.Content && res.Content.subscriptions ? res.Content.subscriptions : [];\r\n            })\r\n        );\r\n    }\r\n\r\n    public getIsValidTokenUrl() {\r\n        return this.getBaseUrl() + 'isvalidtoken/';\r\n    }\r\n\r\n    public getLoginUrl() {\r\n        return this.getBaseUrl() + 'login/';\r\n    }\r\n\r\n    public getLogoutUrl() {\r\n        return this.getBaseUrl() + 'logoff/';\r\n    }\r\n\r\n    public getChangePasswordUrl() {\r\n        return this.getBaseUrl() + 'changepassword/';\r\n    }\r\n\r\n    public getResetPasswordUrl() {\r\n        return this.getBaseUrl() + 'resetpassword/';\r\n    }\r\n\r\n    public getSubsKeysForAccountUrl() {\r\n        return this.getBaseUrl() + 'subscriptionskeysforaccount/';\r\n    }\r\n\r\n    public logoff() {\r\n        const logoffRequest: LogoffRequest = new LogoffRequest(this.getToken());\r\n\r\n        return this.http\r\n            .post<LogoffResponse>(this.getLogoutUrl(), logoffRequest)\r\n            .pipe(\r\n                map((logoffResponse: LogoffResponse) => {\r\n                    if (logoffResponse.Result) {\r\n                        this.clearStorage();\r\n                        this.loggedOut$.next();\r\n                    }\r\n\r\n                    return logoffResponse;\r\n                })\r\n            )\r\n            .toPromise();\r\n    }\r\n\r\n    public clearStorage() {\r\n        sessionStorage.removeItem(StorageVars.JWT);\r\n        sessionStorage.removeItem(StorageVars.CULTURE);\r\n        sessionStorage.removeItem(StorageVars.UI_CULTURE);\r\n        sessionStorage.removeItem(StorageVars.ACCOUNT_ROLES);\r\n\r\n        localStorage.removeItem(StorageVars.JWT);\r\n        localStorage.removeItem(StorageVars.CULTURE);\r\n        localStorage.removeItem(StorageVars.UI_CULTURE);\r\n        localStorage.removeItem(StorageVars.ACCOUNT_ROLES);\r\n    }\r\n\r\n    storageSubscriptionData(subscriptionKey: string, subscriptionDescription: string) {\r\n        if (this.env.auth.sessionStorage) {\r\n            sessionStorage.setItem(StorageVars.SUBSCRIPTION, subscriptionKey);\r\n            sessionStorage.setItem(StorageVars.SUBSCRIPTION_DESCRIPTION, subscriptionDescription);\r\n        } else {\r\n            localStorage.setItem(StorageVars.SUBSCRIPTION, subscriptionKey);\r\n            localStorage.setItem(StorageVars.SUBSCRIPTION_DESCRIPTION, subscriptionDescription);\r\n        }\r\n    }\r\n\r\n    private storageData(loginResponse: LoginResponse) {\r\n        const respCulture: string =\r\n            loginResponse.RegionalSettings === undefined || loginResponse.RegionalSettings.length === 0\r\n                ? window.navigator.language\r\n                : loginResponse.RegionalSettings;\r\n        const respUiCulture: string =\r\n            loginResponse.Language === undefined || loginResponse.Language.length === 0\r\n                ? window.navigator.language\r\n                : loginResponse.Language;\r\n\r\n        if (this.env.auth.sessionStorage) {\r\n            sessionStorage.setItem(StorageVars.JWT, loginResponse.JwtToken);\r\n            sessionStorage.setItem(StorageVars.CULTURE, respCulture);\r\n            sessionStorage.setItem(StorageVars.UI_CULTURE, respUiCulture);\r\n            sessionStorage.setItem(StorageVars.ACCOUNT_ROLES, JSON.stringify(loginResponse.Roles));\r\n        } else {\r\n            localStorage.setItem(StorageVars.JWT, loginResponse.JwtToken);\r\n            localStorage.setItem(StorageVars.CULTURE, respCulture);\r\n            localStorage.setItem(StorageVars.UI_CULTURE, respUiCulture);\r\n            localStorage.setItem(StorageVars.ACCOUNT_ROLES, JSON.stringify(loginResponse.Roles));\r\n        }\r\n    }\r\n\r\n    public saveCulture(culture: string, uiCulture: string) {\r\n        if (this.env.auth.sessionStorage) {\r\n            sessionStorage.setItem(StorageVars.CULTURE, culture);\r\n            sessionStorage.setItem(StorageVars.UI_CULTURE, uiCulture);\r\n        } else {\r\n            localStorage.setItem(StorageVars.CULTURE, culture);\r\n            localStorage.setItem(StorageVars.UI_CULTURE, uiCulture);\r\n        }\r\n    }\r\n\r\n    getToken() {\r\n        if (this.env.auth.sessionStorage) return sessionStorage.getItem(StorageVars.JWT);\r\n        else return localStorage.getItem(StorageVars.JWT);\r\n    }\r\n\r\n    getAccountName() {\r\n        if (this.env.auth.sessionStorage) return sessionStorage.getItem(StorageVars.ACCOUNT_NAME);\r\n        else return localStorage.getItem(StorageVars.ACCOUNT_NAME);\r\n    }\r\n\r\n    getSubscription() {\r\n        if (this.env.auth.sessionStorage) return sessionStorage.getItem(StorageVars.SUBSCRIPTION);\r\n        else return localStorage.getItem(StorageVars.SUBSCRIPTION);\r\n    }\r\n\r\n    getSubscriptionDescription() {\r\n        if (this.env.auth.sessionStorage) return sessionStorage.getItem(StorageVars.SUBSCRIPTION_DESCRIPTION);\r\n        else return localStorage.getItem(StorageVars.SUBSCRIPTION_DESCRIPTION);\r\n    }\r\n\r\n    getAuthServiceUrl = (): string => this.env.auth.url;\r\n    getRedirectUrl = (): string => this.env.auth.redirectUrl;\r\n    hasSubscriptionSelection = (): boolean => this.env.auth.subscriptionSelection;\r\n    getAppId = (): string => this.env.auth.appId;\r\n    isSessionStorage = (): boolean => this.env.auth.sessionStorage;\r\n    getCustomLogo = (): string => this.env.auth.logo;\r\n\r\n    stopCheckingConnection() {\r\n        try {\r\n            this.offlineSubscription.unsubscribe();\r\n            this.onlineSubscription.unsubscribe();\r\n            this.httpSubscription.unsubscribe();\r\n        } catch (e) {\r\n            console.error('TbAuthService.ngOnDestroy()');\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.stopCheckingConnection();\r\n    }\r\n}\r\n","import { Injectable, Inject } from '@angular/core';\r\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, Router } from '@angular/router';\r\n\r\nimport { TbAuthService } from './auth.service';\r\nimport { LoginRequest } from './models/login-request';\r\nimport { TbAuthEnvironment } from './models/auth-environment';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TbAuthGuard implements CanActivate {\r\n    constructor(private authService: TbAuthService, private router: Router, @Inject('env') private env: TbAuthEnvironment) {}\r\n\r\n    async canActivate(next: ActivatedRouteSnapshot, state: RouterStateSnapshot): Promise<boolean> {\r\n        // console.log('ActivatedRouteSnapshot', next, state.url);\r\n\r\n        /**\r\n         * Se ricevo jwt e subKey significa che devo fare una \"autologin\"\r\n         * Creo un LoginRequest con i valori ricevuti, integro con appid letto da environment ed effettuo una login specifica\r\n         * In caso positivo vado in homepage \"/\"\r\n         */\r\n        const jwt = next.queryParams.hasOwnProperty('jwt') ? next.queryParams.jwt : null;\r\n        const subKey = next.queryParams.hasOwnProperty('subKey') ? next.queryParams.subKey : null;\r\n        if (jwt && subKey) {\r\n            const loginRequest: LoginRequest = new LoginRequest();\r\n            loginRequest.token = jwt;\r\n            loginRequest.subscriptionKey = subKey;\r\n            loginRequest.appId = this.authService.getAppId();\r\n\r\n            const loginResponse = await this.authService.login(loginRequest).catch(err => {\r\n                this.authService.errorMessage = err.error && err.error.Message;\r\n                this.router.navigate(['login']);\r\n                return;\r\n            });\r\n\r\n            if (!loginResponse) {\r\n                this.router.navigate(['login']);\r\n                return false;\r\n            }\r\n\r\n            if (loginResponse.Result) {\r\n                this.authService.errorMessage = '';\r\n                this.router.navigate([this.authService.getRedirectUrl()]);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Se arrivo qua vuol dire che ho giÃ  un token salvato e non scaduto quindi chiedo conferma della validitÃ \r\n         */\r\n        const authtoken = this.authService.getToken();\r\n        if (authtoken) {\r\n            // ho un token, ma ne verifico la validitÃ \r\n            const res = await this.authService.isValidToken(authtoken);\r\n            if (res.Result) {\r\n                if (state.url.includes('/login')) this.router.navigate([this.authService.getRedirectUrl()]);\r\n                return true;\r\n            } else {\r\n                this.router.navigate(['login']);\r\n                return false;\r\n            }\r\n        } else {\r\n            // non sono loggato quindi vado alla login\r\n            if (!state.url.includes('/login')) this.router.navigate(['login']);\r\n            return true;\r\n        }\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpRequest, HttpHandler, HttpEvent, HttpInterceptor } from '@angular/common/http';\r\n\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { TbAuthService } from './auth.service';\r\n\r\n@Injectable()\r\nexport class TbAuthInterceptor implements HttpInterceptor {\r\n    constructor(private authService: TbAuthService) {}\r\n\r\n    intercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n        let token = JSON.stringify({ type: 'app', appId: 'LOGINAPP', securityValue: '1l4r14m' });\r\n\r\n        /**\r\n         * Aggiungo a ogni httprequest l'header 'Authorization'\r\n         * In caso di api \"pubbliche\" come /subscriptionskeysforaccount, uso un token \"di applicazione\"\r\n         */\r\n        if (!request.url.includes('/subscriptionskeysforaccount')) {\r\n            const jwt = this.authService.getToken();\r\n            if (jwt) token = JSON.stringify({ type: 'jwt', appId: '', securityValue: jwt });\r\n        }\r\n\r\n        request = request.clone({\r\n            setHeaders: {\r\n                Authorization: token\r\n            }\r\n        });\r\n\r\n        /*\r\n         * Elabora la response di ogni chiamata http\r\n         */\r\n        return next.handle(request).pipe();\r\n    }\r\n}\r\n","import { Component, OnInit, Inject } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\nimport { TbAuthService } from '../auth.service';\r\n\r\nimport { LoginRequest } from '../models/login-request';\r\nimport { StorageVars } from '../models/storage-vars';\r\nimport { TbAuthEnvironment } from '../models/auth-environment';\r\nimport { Subscription } from '../models/subscription.model';\r\nimport { AuthConnectionState } from '../models/auth-connection-state';\r\n\r\n@Component({\r\n    selector: 'tb-login',\r\n    templateUrl: './login.component.html',\r\n    styleUrls: ['./login.component.scss']\r\n})\r\nexport class TbLoginComponent implements OnInit {\r\n    private cachedCompanies: Array<any> = [];\r\n\r\n    capsLockOn = false;\r\n    loading = false;\r\n    loginRequest: LoginRequest;\r\n    redirectUrl: string;\r\n    subscriptionSelection: boolean; // abilita la scelta della subscription\r\n    loginSubscriptions: Array<{ description: string; subscriptionkey: string }> = [];\r\n    logoUrl: string;\r\n    isConnected = true;\r\n    connectionService!: AuthConnectionState;\r\n\r\n    constructor(public authService: TbAuthService, public router: Router, @Inject('env') private env: TbAuthEnvironment) {\r\n        this.loginRequest = new LoginRequest();\r\n        this.loginRequest.appId = authService.getAppId();\r\n        this.subscriptionSelection = authService.hasSubscriptionSelection();\r\n        this.redirectUrl = authService.getRedirectUrl();\r\n        this.logoUrl = authService.getCustomLogo();\r\n\r\n        this.authService.monitorConnectionStatus().subscribe((acs: AuthConnectionState) => {\r\n            this.isConnected = acs.hasBackendAccess;\r\n        });\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.loadLoginData();\r\n    }\r\n\r\n    keyUpFunction(event: KeyboardEvent) {\r\n        if (event.key === 'Enter') {\r\n            if (\r\n                this.loginRequest.accountName &&\r\n                ((this.subscriptionSelection && this.loginSubscriptions.length > 0) || !this.subscriptionSelection)\r\n            )\r\n                this.login();\r\n        }\r\n        const capsOn = event.getModifierState && event.getModifierState('CapsLock');\r\n        this.capsLockOn = capsOn;\r\n    }\r\n\r\n    disabledButton() {\r\n        return (\r\n            !this.isConnected ||\r\n            !this.loginRequest.accountName ||\r\n            !this.loginRequest.password ||\r\n            (this.subscriptionSelection && this.loginSubscriptions.length === 0) ||\r\n            this.loading\r\n        );\r\n    }\r\n\r\n    accountNameBlur() {}\r\n\r\n    async login() {\r\n        this.authService.errorMessage = '';\r\n        this.saveLoginData();\r\n        this.loading = true;\r\n\r\n        const result = await this.authService.login(this.loginRequest).catch(err => {\r\n            this.loading = false;\r\n            this.authService.errorMessage = err.error && err.error.Message;\r\n            return;\r\n        });\r\n\r\n        this.loading = false;\r\n\r\n        // todo controlla come vengono mostrati errori sia login sia checkdb\r\n        if (result && result.Result) {\r\n            this.authService.errorMessage = '';\r\n            this.authService.stopCheckingConnection();\r\n            this.router.navigate([this.redirectUrl]);\r\n        } else {\r\n            this.loading = false;\r\n        }\r\n    }\r\n\r\n    loadLoginData() {\r\n        this.loginRequest.accountName = this.authService.getAccountName() || '';\r\n        this.loginRequest.subscriptionKey = this.authService.getSubscription() || '';\r\n\r\n        if (!this.loginRequest.accountName) {\r\n            this.loginRequest.subscriptionKey = '';\r\n        } else {\r\n            this.getCompaniesForUser(this.loginRequest.accountName);\r\n        }\r\n    }\r\n\r\n    private saveLoginData() {\r\n        if (this.authService.isSessionStorage()) {\r\n            sessionStorage.setItem(StorageVars.ACCOUNT_NAME, this.loginRequest.accountName);\r\n            sessionStorage.setItem(StorageVars.SUBSCRIPTION, this.loginRequest.subscriptionKey);\r\n        } else {\r\n            localStorage.setItem(StorageVars.ACCOUNT_NAME, this.loginRequest.accountName);\r\n            localStorage.setItem(StorageVars.SUBSCRIPTION, this.loginRequest.subscriptionKey);\r\n        }\r\n\r\n        if (this.loginSubscriptions.length > 0) {\r\n            const sd = this.loginSubscriptions.find(s => s.subscriptionkey === this.loginRequest.subscriptionKey);\r\n            if (sd) {\r\n                if (this.authService.isSessionStorage()) {\r\n                    sessionStorage.setItem(StorageVars.SUBSCRIPTION_DESCRIPTION, sd.description);\r\n                } else {\r\n                    localStorage.setItem(StorageVars.SUBSCRIPTION_DESCRIPTION, sd.description);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    async getCompaniesForUser(user: string) {\r\n        if (!user || !this.subscriptionSelection) {\r\n            this.loginRequest.subscriptionKey = '';\r\n            return;\r\n        }\r\n\r\n        this.loginSubscriptions = [];\r\n        this.loginRequest.subscriptionKey = '';\r\n        this.authService.errorMessage = '';\r\n\r\n        const temp = await this.requestAndSortSubscriptions(user);\r\n        // Premio Eleganza Codice 2019 (@LucaBruni)\r\n        if (JSON.stringify(temp) !== JSON.stringify(this.loginSubscriptions)) this.loginSubscriptions = temp;\r\n\r\n        if (this.loginSubscriptions.length === 0) {\r\n            this.loginRequest.subscriptionKey = '';\r\n            localStorage.removeItem(StorageVars.SUBSCRIPTION);\r\n            localStorage.removeItem(StorageVars.SUBSCRIPTION_DESCRIPTION);\r\n            this.authService.errorMessage = 'No Subscriptions associated to this user';\r\n        }\r\n\r\n        if (this.loginSubscriptions.length > 0) {\r\n            if (!this.loginRequest.subscriptionKey) {\r\n                this.loginRequest.subscriptionKey = this.loginSubscriptions[0].subscriptionkey;\r\n            } else {\r\n                if (this.loginSubscriptions.map(s => s.subscriptionkey).indexOf(this.loginRequest.subscriptionKey) === -1) {\r\n                    this.loginRequest.subscriptionKey = this.loginSubscriptions[0].subscriptionkey;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private async requestAndSortSubscriptions(user: string): Promise<Array<Subscription>> {\r\n        if (this.cachedCompanies.hasOwnProperty(user) && this.cachedCompanies[user as any]) {\r\n            return this.cachedCompanies[user as any];\r\n        }\r\n\r\n        const temp: Array<Subscription> = [];\r\n        const result: Array<Subscription> = await this.authService.getCompaniesForUser(user).toPromise();\r\n        result.sort(this.compareCompanies).forEach(c => {\r\n            temp.push({ subscriptionkey: c.subscriptionkey, description: c.description });\r\n        });\r\n\r\n        if (temp.length > 0) this.cachedCompanies[user as any] = temp;\r\n\r\n        return temp;\r\n    }\r\n\r\n    private compareCompanies(c1: Subscription, c2: Subscription) {\r\n        if (c1.description > c2.description) {\r\n            return 1;\r\n        } else if (c1.description < c2.description) {\r\n            return -1;\r\n        }\r\n        return 0;\r\n    }\r\n}\r\n","import { Component } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { TbAuthService } from './auth.service';\n\n@Component({\n    selector: 'tb-logoff',\n    template: ''\n})\nexport class TbLogoffComponent {\n    constructor(public authService: TbAuthService, public router: Router) {\n        const authtoken = authService.getToken();\n        if (authtoken) authService.logoff();\n        router.navigate(['/login']);\n    }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { InputsModule } from '@progress/kendo-angular-inputs';\nimport { ButtonsModule } from '@progress/kendo-angular-buttons';\nimport { DropDownsModule } from '@progress/kendo-angular-dropdowns';\n\nimport { TbLoginComponent } from './pages/login.component';\nimport { TbLogoffComponent } from './logoff.component';\n\nimport { TbAuthService } from './auth.service';\n\nimport { TbAuthGuard } from './auth.guard';\n\nconst routes: Routes = [\n    { path: 'login', component: TbLoginComponent, canActivate: [TbAuthGuard] },\n    { path: 'logoff', component: TbLogoffComponent, canActivate: [TbAuthGuard], pathMatch: 'full' }\n];\n\n@NgModule({\n    declarations: [TbLoginComponent, TbLogoffComponent],\n    imports: [CommonModule, FormsModule, InputsModule, ButtonsModule, DropDownsModule, RouterModule.forRoot(routes)],\n    exports: [TbLoginComponent, TbLogoffComponent, RouterModule]\n})\nexport class TbAuthModule {\n    static forRoot(): ModuleWithProviders {\n        return {\n            ngModule: TbAuthModule,\n            providers: [TbAuthService]\n        };\n    }\n}\n"],"names":["_.defaults"],"mappings":"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"}